import { EOL } from 'node:os'
import { getComponentList } from './get-component-list'
import { logger } from './utils/logger'
import { writeFileSync } from 'node:fs'

export async function generateComponentListFile(output: string) {
  try {
    const componentList = await getComponentList()
    const componentListName = componentList.map(({ name }) => `  '${name}',`)
    const template = `/* Automatically generated by './build/generate-component-list-file.js' */

export const componentList = [${EOL}${componentListName.join(EOL)}${EOL}]${EOL}`

    writeFileSync(output, template)

    logger.success(`[generateComponentListFile] âœ…`)
  } catch (error) {
    logger.error(
      `[generateComponentListFile] ðŸ”´ Error occurred while generating components list file`,
      error,
    )
  }
}
