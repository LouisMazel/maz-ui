const fs = require('fs')
const render = require('json-templater/string')
const path = require('path')
const endOfLine = require('os').EOL

const OUTPUT_PATH = path.join(__dirname, './../scss/style-helpers/variables/_root-variables.scss')

const MAIN_TEMPLATE = `
/* Automatically generated by './packages/theme-builder' */

/* stylelint-disable */

:root {
{{light_include}}
}

.maz-is-dark {
{{dark_include}}
}

/* stylelint-enalble */
`

module.exports = (variables) => {
  const lightProperties = Object.entries(variables.light).map((values) => `  ${values[0]}: ${values[1]};`).join(endOfLine)
  const darkProperties = Object.entries(variables.dark).map((values) => `  ${values[0]}: ${values[1]};`).join(endOfLine)

  const template = render(MAIN_TEMPLATE, {
    light_include: lightProperties,
    dark_include: darkProperties
  })

  fs.writeFileSync(OUTPUT_PATH, template)
  console.log('\x1b[32m', '[build root css file] DONE:', OUTPUT_PATH)
}
